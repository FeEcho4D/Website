<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FeEcho4D</title>
  <meta name="description" content="FeEcho4D: A Radial 4D Fetal Echocardiography Dataset" />

  <!-- Bootstrap & Favicon -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
  <link rel="icon" href="Image/Logo/favicon.ico" type="image/x-icon" />

  <style>
    /* =========================
       Font faces
       ========================= */
    @font-face {
      font-family: 'Imperial Sans Display';
      src: url('fonts/ImperialSansDisplay-Light.woff2') format('woff2');
      font-weight: 300;
    }
    @font-face {
      font-family: 'Imperial Sans Display';
      src: url('fonts/ImperialSansDisplay-Semibold.woff2') format('woff2');
      font-weight: 600;
    }

    /* =========================
       Global base styles
       ========================= */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Imperial Sans Display', sans-serif;
      background-color: #ffffff;
      color: #363636;
    }

    /* Semi-transparent global background texture */
    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url('Image/Logo/IMPERIAL_Pattern_Reactive_6_varied_size_CMYK.png') center center repeat;
      background-size: 700px auto;
      opacity: 0.05;
      z-index: -1;
      pointer-events: none;
    }

    /* Top white bar (fixed) */
    .top-bar {
      background-color: #ffffff;
      height: 60px;
      display: flex;
      align-items: center;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1200;
      padding-left: 20px;
    }

    /* Logo styles */
    .top-bar img {
      height: 30px;
    }

    /* Navigation on the right side of the top bar */
    .nav-right-bottom {
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      gap: 10px;
    }
    .nav-right-bottom a {
      font-size: 1rem;
      color: #0434e2;
      text-decoration: none;
      font-weight: 400;
    }
    .nav-right-bottom a:hover {
      text-decoration: underline;
    }

    /* Gray header (site hero section) */
    .header-section {
      position: relative;
      padding: 80px 10px 10px;
      text-align: center;
      background-color: transparent; /* or just remove this line */
    }
        .header-section h1 {
      font-size: 5rem;
      font-weight: 600;
      color: white;
      margin-top: 30px;
      margin-bottom: 10px;
    }
    .header-section p {
      font-size: 1rem;
      font-weight: 400;
      color: white;
      font-style: italic;
    }
    .header-content {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 40px;
      flex-wrap: wrap;
    }
    .header-icon {
      width: 120px;
      max-width: 20vw;
      flex-shrink: 0;
    }

    /* Left & right side images (optional decorative) */
    .side-image {
      position: absolute;
      top: 55%;
      transform: translateY(-50%);
      width: 200px;
      height: auto;
      opacity: 0.9;
      z-index: 900;
    }
    .left-image { left: 100px; }
    .right-image { right: 100px; }

    /* Hide side images on smaller screens */
    @media (max-width: 1400px) {
      .side-image { display: none; }
    }
    @media (max-width: 768px) {
      .nav-right-bottom { display: none; }
    }

    /* Section spacing */
    .section {
      padding: 40px 20px;
      scroll-margin-top: 140px;
    }
    .section p {
      text-align: justify;
    }
    h2 {
      font-weight: 600;
      color: #0434e2;
    }

    /* Dataset step title styles */
    .step-title {
      color: #0434e2;
      font-style: italic;
      font-size: 1rem;
      font-weight: 600;
      margin-top: 30px;
      margin-bottom: 10px;
      text-align: left;
    }

    /* Centered video helper class */
    video.center {
      display: block;
      margin: 20px auto;
    }

    /* Author section styles */
    .author-section {
      margin-top: 60px;
      padding: 40px 20px;
      background-color: #afafaf;
    }
    .author-container {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 40px;
    }
    .author-card {
      width: 160px;
      text-align: center;
    }
    .author-photo {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #fffbfb;
      margin-bottom: 10px;
    }
    .author-card h6 {
      font-size: 1rem;
      font-weight: 400;
      color: #ffffff;
      margin-bottom: 5px;
    }
    .author-card p {
      font-size: 0.7rem;
      font-weight: 300;
      color: #ffffff;
      font-style: italic;
      margin: 0;
    }
    .author-link {
      color: #ffffff;
      text-decoration: none;
      transition: color 0.2s, text-decoration 0.2s;
    }
    .author-link:hover {
      color: #0434e2;
      text-decoration: underline;
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 30px 0;
      color: #666;
    }
  </style>
</head>

<body>

  <!-- Top logo bar -->
  <div class="top-bar">
    <img src="Image/Logo/IMPERIAL_logo_RGB_Blue_2024.png" alt="IMPERIAL Logo" />

    <!-- Page navigation -->
    <div class="nav-right-bottom">
      <a href="#bg">Study Motive</a>
      <a href="#data_pre">Data Prep</a>
      <a href="#data_rec">3D Recon & Eval</a>
      <a href="#data_acc">Data Access</a>
      <a href="#code">Code & Pubs</a>
    </div>
  </div>

  <!-- Hero header -->
  <div class="header-section">
    <div class="header-content">
      <!-- Optional left emblem -->
      <!-- <img src="Image/Logo/4DFetal_Logo.png" alt="Left Logo" class="side-image left-image"> -->

      <!-- Title and subtitle -->
      <div class="header-text" 
      style="background-image: url('Image/Logo/FeEcho.png');
             background-size: contain;      /* shows whole logo, scaled */
             background-repeat: no-repeat;
             background-position: center top;
             background-color: #2b2929;        /* fallback background */
             padding: 0px 0px;           /* add enough top/bottom space for logo */
             text-align: center;
             color: white;
             position: relative;">
   <h1 style="font-size: 80px; font-weight: bold; 
   color: red; 
   text-shadow: 2px 2px 8px rgba(0,0,0,0.6); 
   animation: blink 2s infinite;">
    FeEcho4D
    </h1>

    <style>
    @keyframes blink {
    0%, 50%, 100% { opacity: 1; }
    25%, 75% { opacity: 0; }
    }
    </style>
  
    <p style="font-size: 24px; 
    font-weight: 500; 
    text-shadow: 1px 1px 6px rgba(0,0,0,0.7);
    margin-top: 0px; 
    margin-bottom: 0px;">
    The First Benchmark 4D Fetal Echocardiography Dataset with 4D Left Ventricular Meshes   
  </p>
 </div>
 
 

      <!-- Optional right emblem -->
      <!-- <img src="Image/Logo/Yaplab_Logo.png" alt="Right Logo" class="side-image right-image"> -->
    </div>
  </div>

  <!-- Main container -->
  <div class="container">

    <!-- Background & Motivation -->
    <section id="bg" class="section">
      <h2>Background & Motivation</h2>
      <p>
        Fetal echocardiography is the primary tool for prenatal detection of congenital heart disease (CHD) and assessment of cardiac function, 
        guiding early intervention and parental decision-making. However, 2D fetal CHD screening achieves only ~50% detection accuracy and exhibits 
        substantial variability across studies, often due to human error, subjectivity, and limited anatomical coverage. While 2D imaging remains standard 
        in clinical practice, it can miss structural defects or provide incomplete views due to foreshortening, probe misalignment, or restricted field of 
        view. In contrast, 3D echocardiography captures the full heart volume without requiring precise alignment and can improve both detection and functional 
        assessment. Nonetheless, although 3D/4D fetal echocardiography is available via Spatio-Temporal Image Correlation (STIC) acquisitions, 
        it remains underused due to challenges in visualization and quantification. Deep learning (DL)–based 3D/4D cardiac reconstruction offers 
        a practical solution to these limitations. To date, however, no DL algorithm has been developed for reconstructing cardiac geometry from 
        3D/4D fetal echocardiography. This gap is driven by two key factors: the lack of a public 3D/4D dataset and the inherent difficulty of generating accurate 
        3D ground-truth masks. Preparing such annotations is especially time-consuming in fetal imaging, where myocardial boundaries can be ambiguous, such as 
        determining the transition from a U-shaped myocardium to a circular cross-section near the lateral wall. To address this, we introduce FeEcho4D, a first 
        benchmark 4D fetal echocardiography dataset via 2.5D radial segmentation and slice-to-mesh reconstruction (3D) over time (4D), as shown in the following figure. 
      </p>  
        
      <p>
        Radial slicing is a promising yet underexplored alternative to conventional Cartesian slicing. By rotating a 2D slicing plane around the left ventricular 
        long axis at fixed angular intervals (θ∈[0,π]), it provides structured coverage of the myocardium from multiple orientations. Compared with fixed short-axis 
        (SAX) and long-axis (LAX) views, radial slices are easier to annotate and deliver more uniform anatomical coverage across the heart.
      </p>  

      <img src="Image/Introduction.png" alt="Intro image" 
     style="display:block; margin:0 auto; max-width:100%; height:auto;">
      <p class="figure-caption">
        <strong>Figure:</strong> Overview of the FeEcho4D dataset creation pipeline (A) Radial data preparation and (B) 4D reconstruction of fetal myocardial segmentation.
        </p>

      <p><strong>FeEcho4D</strong> is the first benchmark dataset for fetal radial echocardiography with full 4D (3D+t) temporal coverage, designed to advance 
        prenatal cardiac functional assessment and support clinical translation. It contains over <strong>1,845 expert-annotated 3D radial volumes</strong> from 52 subjects, 
        covering diverse gestational ages and fetal poses to capture the complexity of real-world imaging. <em>Additional segmented cases are in progress and will be published in future releases</em>.
        FeEcho4D enables reliable segmentation, motion estimation, and 3D reconstruction for AI-driven fetal cardiac analysis. As illustrated in the figure above, dataset development involves six key steps:</p>

          <ol>
              <li><strong>Data extraction</strong> from raw STIC acquisitions using <em>4DView</em> software (GE Healthcare, Chicago, IL, USA).</li>
              <li><strong>Radial slice extraction</strong> at each time frame.</li>
              <li><strong>Manual delineation</strong> of myocardium at clinically important time points—end-diastole (ED) and end-systole (ES).</li>
              <li><strong>Motion tracking</strong> to generate masks for intermediate frames.</li>
              <li><strong>Manual refinement</strong> of the propagated masks to correct tracking errors.</li>
              <li><strong>Slice-to-mask reconstruction</strong> for all time frames, producing complete 4D segmentations of each fetal echocardiography volume.</li>
          </ol>

          <style>
            @keyframes fadeSlideIn {
              from { 
                opacity: 0;
                transform: translateY(15px);
              }
              to { 
                opacity: 1;
                transform: translateY(0);
              }
            }
            .animated-text {
              color: #0056b3;
              font-weight: bold;
              animation: fadeSlideIn 2s ease-in-out;
              animation-delay: 0.3s;
            }
          </style>
          
          <p class="animated-text">
            All steps are described in detail below, including technical and implementation specifics, to ensure reproducibility.
          </p>
          
    </section>

    <!-- Dataset Preparation & Annotation -->
    <section id="data_pre" class="section">
      <h2>Dataset Preparation & Annotation</h2>

      <!-- Step 1 -->
      <h4 class="step-title">Step 1: Data extraction</h4>
      <p>
       Raw spatiotemporal image correlation (STIC) acquisitions were retrieved directly from the fetal echocardiography system and processed using 
       4DView software (GE Healthcare, Chicago, IL, USA) to export volumetric datasets. 
       This step ensures that the original 4D ultrasound information, including both spatial and temporal components, is preserved for subsequent analysis.
       <div style="box-sizing:border-box; width:100%; padding:0 8px; margin:0 auto; overflow-x:hidden;">
        <div style="display:flex; gap:10px; justify-content:center; align-items:stretch; flex-wrap:nowrap;
                    height:clamp(160px, 35vw, 380px);">
          <video src="Image/Dataset-Step1-Data_extraction-1.mov"
                 autoplay loop muted playsinline
                 style="flex:0 0 calc(70% - 5px); height:100%; width:100%; object-fit:contain; display:block; border-radius:6px;">
          </video>
      
          <img src="Image/Dataset-Step1-Data_extraction-2.gif"
               alt="Data extraction step"
               style="flex:0 0 calc(70% - 5px); height:100%; width:100%; object-fit:contain; display:block; border-radius:6px;">
        </div>
      </div>
      <p class="figure-caption">
        <strong>Figure:</strong> Step1 - Raw STIC fetal echocardiography volume exported via 4DView software and corresponding radial slices at selected time frames.
        </p>
      

      <!-- Step 2 -->
      <h4 class="step-title">Step 2: Radial slice extraction</h4>
      <p>
        All volumes are radially resampled, aligning the center to the 2D image origin. This creates uniformly sampled S radial slices 
        (H × W) at fixed angular intervals, forming structured 3D volumes for consistent downstream analysis.
      </p>
      <video class="center" width="1000" controls autoplay muted loop>
        <source src="Image/Dataset-Step2-Radial_Resampling.mov" type="video/mp4">
      </video>
      <p class="figure-caption">
        <strong>Figure:</strong> Step2 - Radial slice extraction at a given rotation angle (θ) with corresponding ultrasound image and myocardium mask.
        </p>

      <!-- Algorithm block: Radial Slice Extraction -->
      <details class="rounded-lg border p-3 my-3" style="background:#fafafa;">
        <summary style="cursor:pointer;"><strong>Algorithm 1 — Radial Slice Extraction</strong></summary>
        <div style="margin-top:10px; line-height:1.55;">
          <p>
            <em>Inputs</em>: 3D volume \( \mathbf{V}\in \mathbb{R}^{H \times W \times D} \), spacing \( \mathbf{S}=[s_x,s_y,s_z] \), angle set \( \Theta \).<br>
            <em>Outputs</em>: Radial slices \( \{ I_\theta \mid \theta \in \Theta \},\; I_\theta \in \mathbb{R}^{H \times W} \).
          </p>
          <ol>
            <li>Select middle slice index \( \mathbf{M} \) along z and rotation center \( \mathbf{C}=[C_x,C_y] \) on that slice (LV center).</li>
            <li>
              Generate coordinate mesh \( \mathbf{X}=\{(x_i,y_j,z_k)\} \) with voxel spacing:
              \[
              \begin{aligned}
              x_i &= i\cdot s_x,\quad i=1,\dots,W \\
              y_j &= j\cdot s_y,\quad j=1,\dots,H \\
              z_k &= k\cdot s_z,\quad k=1,\dots,D
              \end{aligned}
              \]
            </li>
            <li>
              Translate to center:
              \[
              \mathbf{X}^C_p = \mathbf{X}_p - [\,C_x s_x,\; C_y s_y,\; M s_z\,],\quad p\in\{i,j,k\}.
              \]
            </li>
            <li>
              For each \( \theta \in \Theta \):
              <ol type="a">
                <li>
                  Define y-axis rotation
                  \[
                  R_y(\theta^{\mathrm r})=
                  \begin{bmatrix}
                  \cos\theta^{\mathrm r} & 0 & \sin\theta^{\mathrm r}\\
                  0&1&0\\
                  -\sin\theta^{\mathrm r}&0&\cos\theta^{\mathrm r}
                  \end{bmatrix},\quad
                  \theta^{\mathrm r}=\theta\cdot\frac{\pi}{180}.
                  \]
                </li>
                <li>
                  Rotate and inverse-translate:
                  \[
                  \mathbf{X}^{\mathrm{rot}}=R_y(\theta^{\mathrm r})\,\mathbf{X}^C,\qquad
                  \mathbf{X}^{\mathrm{target}}_p=\mathbf{X}^{\mathrm{rot}}_p+[\,C_x s_x,\; C_y s_y,\; M s_z\,].
                  \]
                </li>
                <li>
                  Interpolate:
                  \[
                  V^{\mathrm{rot}}(i,j,k)=\mathrm{interp3}\!\left(\mathbf{V},\;\mathbf{X}^{\mathrm{target}}\right).
                  \]
                </li>
                <li>Slice at \( k=M \) to obtain \( I_\theta = V^{\mathrm{rot}}(:,:,M) \).</li>
              </ol>
            </li>
          </ol>
        </div>
      </details>

      <!-- Step 3 -->
      <h5 class="step-title">Step 3: Manual delineation</h5>
      <p>
        Using a custom annotation tool, experts mark points along the left ventricular (LV) myocardium and cavity. Given ultrasound 
        noise, users adjust both spatially and temporally to ensure accuracy, refining adjacent slices for smooth contours. All 
        annotations undergo multi-round review and cardiologist validation 
        (<a href="https://github.com/haziqshahard/SegmentationApp" target="_blank">details in our SegmentationApp</a>).
      </p>
      <img src="Image/Dataset-Step3-Segmentation_App.gif" width="1000" class="mx-auto d-block" alt="Manual Annotation" />
      <p class="figure-caption">
        <strong>Figure:</strong> Step3 - Manual delineation of myocardium at ED and ES by SegmentationApp.
        </p>

      <!-- Step 4 -->
      <h5 class="step-title">Step 4: Motion tracking & Manual refinement</h5>
      <p>
        FeEcho4D generates dense cardiac masks by propagating sparse end-diastolic and end-systolic annotations using
        <strong><a href="https://www.nature.com/articles/s41598-020-75525-4" target="_blank">B-spline Fourier (BSF) motion model</a></strong>, 
        which blends local and global deformations and regularizes trajectories to capture periodic motion. This ensures temporally 
        coherent, anatomically consistent masks, further refined with <strong>skeleton-based width correction</strong> to maintain uniform myocardial thickness, and all results are manually reviewed for accuracy.
      </p>
      <video class="center" width="1000" controls autoplay muted loop>
        <source src="Image/Dataset-Step4-Motion_Tracking.mov" type="video/mp4">
      </video>
      <p class="figure-caption">
        <strong>Figure:</strong> Step4 - Motion-guided mask propagation across all time frames.
        </p>

      <!-- Algorithm block: BSF-Based Temporal Mask Propagation -->
      <details class="rounded-lg border p-3 my-3" style="background:#fafafa;">
        <summary style="cursor:pointer;"><strong>Algorithm 2 — BSF-Based Temporal Mask Propagation</strong></summary>
        <div style="margin-top:10px; line-height:1.55;">
          <p>
            <em>Inputs</em>: Radial slices \( \{x_\theta^t\}_{t=1}^T \), ED/ES masks \( M_{\mathrm{ED}}, M_{\mathrm{ES}} \), spacing \( s \), Fourier order \( N \), B-spline level \( L \).<br>
            <em>Outputs</em>: Dense masks \( M_t \in \mathbb{R}^{S\times H\times W},\ t=1,\dots,T \).
          </p>
          <ol>
            <li>
              <strong>(Registration)</strong> For \( t=0 \) to \( T-2 \):
              <ul>
                <li>\(\mathrm{Register}(x_\theta^t, x_\theta^{t+1}) \Rightarrow \mathbf{d}_{t\to t+1}\)</li>
                <li>\(\mathrm{Register}(x_\theta^0, x_\theta^{t+1}) \Rightarrow \mathbf{d}_{0\to t+1}\)</li>
              </ul>
            </li>
            <li>
              <strong>(Grid Initialization)</strong>:
              \[
              \mathbf{X}_0 = \mathrm{GridFromMask}(M_{\mathrm{ED}})
              \]
            </li>
            <li>
              <strong>(Grid Propagation)</strong> For \( t=0 \) to \( T-2 \):
              \[
              \mathbf{X}_{t+1} = w(t)\cdot(\mathbf{X}_t + \mathbf{d}_{t\to t+1}) + (1-w(t))\cdot(\mathbf{X}_0 + \mathbf{d}_{0\to t+1})
              \]
            </li>
            <li>
              <strong>(BSF Fitting)</strong>:
              \[
              \mathbf{X}^{\mathrm{BSF}}_t = \sum_{f=0}^N \mathbf{F}_f \cos\!\left(\frac{2\pi f t}{P}\right) + \mathbf{F}_{f+N+1} \sin\!\left(\frac{2\pi f t}{P}\right)
              \]
              \[
              \mathbf{F}_f(x,y) = \sum_{i,j} B_i(x) B_j(y)\cdot \mathbf{C}_{i,j,f}
              \]
            </li>
            <li>
              <strong>(Trajectory Correction)</strong>:
              Repeat until cost &lt; threshold:
              <ul>
                <li>
                  For each control point \( u \):
                  \[
                  \mathbf{C}_u = \arg\min \sum_{t,\Delta t} \left\| \mathbf{X}^{\mathrm{BSF}}_{t+\Delta t} - \mathbf{X}^{\mathrm{BSF}}_t - \mathbf{d}_{t\to t+\Delta t} \right\|^2
                  \]
                </li>
              </ul>
            </li>
            <li>
              <strong>(Mask Synthesis)</strong>:
              For \( t=0 \) to \( T-1 \), for each \( p\in M_{\mathrm{ED}} \):
              <ul>
                <li>\( p_t = \mathbf{X}^{\mathrm{BSF}}_t(p) \), set \( M_t(p_t) \leftarrow 1 \)</li>
              </ul>
            </li>
          </ol>
          <p><strong>Return</strong>: \( \{M_t\}_{t=1}^T \)</p>
        </div>
      </details>

      <!-- Algorithm block: Skeleton-Based 2D Mask Refinement -->
      <details class="rounded-lg border p-3 my-3" style="background:#fafafa;">
        <summary style="cursor:pointer;"><strong>Algorithm 3 — Skeleton-Based 2D Mask Refinement</strong></summary>
        <div style="margin-top:10px; line-height:1.55;">
          <p>
            <em>Inputs</em>: Raw propagated mask \( M_t \in \mathbb{R}^{S\times H\times W} \); tail–ratio \( \tau\in(0,1) \); opening radius \( r \ge 0 \).<br>
            <em>Outputs</em>: Refined mask \( \widetilde{M}_t \in \mathbb{R}^{S\times H\times W} \) with consistent width.
          </p>
          <ol>
            <li>
              For \( s = 1 \) to \( S \):
              <ol type="a">
                <li><strong>(Component Selection)</strong>: \( M'_s \gets \mathrm{LargestComponent}(M_t[s]) \)</li>
                <li><strong>(Skeleton Extraction)</strong>: \( S_s \gets \mathrm{Skeletonize}(M'_s) \)</li>
                <li>
                  <strong>(Tail Extrapolation)</strong>: Let \( S_{\mathrm{tail}} \) be the \( \lceil \tau |S_s| \rceil \) farthest points from \( \mathrm{centroid}(S_s) \);  
                  Fit line \( \ell_s \) via least squares and set \( S_s \gets S_s \cup (\ell_s \setminus S_s) \)
                </li>
                <li>
                  <strong>(Mean Half-Width Estimation)</strong>:
                  \[
                  d(x) = \min_{y \in \overline{M'_s}} \| x - y \|_2,\quad x \in \Omega
                  \]
                  \[
                  h_s = \left\lfloor \frac{1}{|S_s|} \sum_{x \in S_s} d(x) + \frac{1}{2} \right\rfloor
                  \]
                </li>
                <li>
                  <strong>(Uniform Mask Synthesis)</strong>:
                  \[
                  \widetilde{M}_t[s] = \{ x \in \Omega \mid \mathrm{dist}(x, S_s) \le h_s \}
                  \]
                  If \( r > 0 \):
                  \[
                  \widetilde{M}_t[s] \gets \mathrm{Opening}(\widetilde{M}_t[s],\ \mathrm{disk}(r))
                  \]
                </li>
              </ol>
            </li>
          </ol>
          <p><strong>Return</strong>: \( \widetilde{M}_t \)</p>
        </div>
      </details>
    </section>

    <!-- MathJax support (include once, usually in <head>) -->
    <script>
      window.MathJax = {
        tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
        svg: { fontCache: 'global' }
      };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>

    <!-- 3D Reconstruction & Biomarker Computation -->
    <section id="data_rec" class="section">
      <h2>3D Reconstruction & Biomarker Computation</h2>

      <!-- Step 5 -->
      <h5 class="step-title">3D Reconstruction with GHD</h5>
      <p>
        The full 3D+t segmentations are reconstructed into smooth, temporally consistent left ventricular (LV) meshes using 
        <strong>Graph Harmonic Deformation (GHD)</strong> 
        (<a href="https://github.com/Luo-Yihao/GHDHeart" target="_blank">details in our teamwork: GHD</a>). 
        The meshes are further processed with <strong>Differentiable Voxelization & Slicing (DVS)</strong>, enabling differentiable conversion 
        to voxel grids and slices for precise dynamic metrics and seamless integration with learning-based models.
      </p>
      <img src="Image/Dataset-Step5-GHD.png" width="1000" class="mx-auto d-block" alt="GHD Reconstruction" />
      <p class="figure-caption">
        <strong>Figure:</strong> Step5 - Slice-to-volume reconstruction using DVS with GHD mesh fitting.
        </p>

      <!-- Algorithm block: GHD-Based 3D Mesh Reconstruction -->
      <details class="rounded-lg border p-3 my-3" style="background:#fafafa;">
        <summary style="cursor:pointer;"><strong>Algorithm 4 — GHD-Based 3D Mesh Reconstruction</strong></summary>
        <div style="margin-top:10px; line-height:1.55;">
          <p>
            <em>Inputs</em>: Binary mask sequence \( \{M_t\}_{t=1}^T, \; M_t \in \mathbb{R}^{S\times H\times W} \); canonical mesh \( \mathcal{M}_0 \in \mathbb{R}^{V\times 3} \); graph basis \( U \in \mathbb{R}^{V\times B} \); radial slices \( \{x_\theta^t\}_{t=1}^T \).<br>
            <em>Outputs</em>: Deformed mesh sequence \( \{\mathcal{M}_t\}_{t=1}^T,\; \mathcal{M}_t \in \mathbb{R}^{V\times 3} \).
          </p>
          <ol>
            <li>
              <strong>(Point Cloud Sampling)</strong>: For \( t = 1 \) to \( T \):
              <ul>
                <li>Sample myocardium and background point clouds from \( M_t \):  
                  \( P_{\mathrm{myo}}^t, \; P_{\mathrm{bg}}^t \subset \mathbb{R}^{N\times 3} \)
                </li>
              </ul>
            </li>
            <li>
              <strong>(Mesh Deformation)</strong>: For \( t = 1 \) to \( T \):
              <ul>
                <li>Deform canonical mesh using spectral basis:  
                  \( \mathcal{M}_t = \mathcal{M}_0 + U \cdot \phi_t \)
                </li>
                <li>Optimize \( \phi_t \in \mathbb{R}^{B\times 3} \) to minimize total loss</li>
              </ul>
            </li>
            <li>
              <strong>(DVS Supervision)</strong>: For \( t = 1 \) to \( T \):
              <ul>
                <li>Project mesh via DVS:  
                  \( \hat{x}_\theta^t = \mathrm{DVS}(\mathcal{M}_t) \)
                </li>
                <li>Compute Dice loss:  
                  \( \mathcal{L}_{\mathrm{DVS}}^t = 1 - \mathrm{Dice}(x_\theta^t, \hat{x}_\theta^t) \)
                </li>
              </ul>
            </li>
            <li>
              <strong>(Objective Optimization)</strong>:
              \[
              \min_{\phi_t} \; \mathcal{L}_{\mathrm{total}} = \mathcal{L}_{\mathrm{DVS}} + \lambda_1 \mathcal{L}_{\mathrm{lap}} + \lambda_2 \mathcal{L}_{\mathrm{norm}} + \lambda_3 \mathcal{L}_{\mathrm{thick}}
              \]
            </li>
          </ol>
          <p><strong>Return</strong>: \( \{\mathcal{M}_t\}_{t=1}^T \)</p>
        </div>
      </details>
      <p>
        Each dataset frame includes expert-validated masks (LV, MYO) and metadata (gestational age, cardiac phase indices, acquisition 
        parameters, fetal biometry), enabling research in segmentation, tracking, motion analysis, reconstruction, and clinical functional 
        assessment.
      </p>
      <video class="center" width="1000" controls autoplay muted loop>
        <source src="Image/Dataset-Reconstruction_Result.mov" type="video/mp4">
      </video>
      <p class="figure-caption">
        <strong>Figure:</strong> 3D+t reconstruction results.
        </p>
      
      <!-- Step 5 -->
      <h5 class="step-title">Clinical Metrics Calculation</h5>
      <p>
        Clinical metrics including <strong>Stroke Volume (SV)</strong>, <strong>Ejection Fraction (EF)</strong>, 
        <strong>Global Longitudinal Strain (GLS)</strong>, and <strong>Global Circumferential Strain (GCS)</strong> 
        are derived from the reconstructed left ventricular (LV) meshes. SV and EF are computed from 
        endocardial volumes, while GLS and GCS are obtained by averaging changes in apex-to-base lengths 
        and mid-ventricular circumferences across representative planes or cross-sections, excluding 
        extreme outliers for robustness.
      </p>
      <img src="Image/Biomarker Computation.png" width="1000" class="mx-auto d-block" alt="Clinical Metrics" />
      <p class="figure-caption">
        <strong>Figure:</strong> Computation of GLS, GCS, EF, and SV from fitted myocardium meshes at ED and ES.
        </p>

      <!-- Algorithm block: Clinical Metrics Computation -->
      <details class="rounded-lg border p-3 my-3" style="background:#fafafa;">
        <summary style="cursor:pointer;"><strong>Algorithm 5 — Clinical Metrics Computation</strong></summary>
        <div style="margin-top:10px; line-height:1.55;">
          <ol>
            <li>
              <strong>(Volume-Based Metrics)</strong>:
              <ul>
                <li>Measure endocardial volumes \( V_{\mathrm{ENDO,ED}} \) and \( V_{\mathrm{ENDO,ES}} \) at end-diastole (ED) and end-systole (ES).</li>
                <li>
                  Compute:
                  \[
                  SV = EDV - ESV,\quad EF = \frac{EDV - ESV}{EDV} \times 100\%.
                  \]
                </li>
              </ul>
            </li>

            <li>
              <strong>(Global Longitudinal Strain — GLS)</strong>:
              <ul>
                <li>
                  Slice the LV epicardial mesh into \( N \) radial planes aligned with the long axis, indexed by \( \theta \).  
                  <em>(In our study: \( N = 30 \))</em>
                </li>
                <li>For each plane, measure apex-to-base lengths \( L_\theta^{\mathrm{ED}}, L_\theta^{\mathrm{ES}} \).</li>
                <li>
                  Exclude the 5 longest and 5 shortest planes to retain \( N' \) representative planes.  
                  <em>(In our study: \( N' = 20 \))</em>
                </li>
                <li>
                  Compute:
                  \[
                  GLS = \frac{\frac{1}{N'}\sum_{\theta\notin OL} L_\theta^{\mathrm{ES}} - \frac{1}{N'}\sum_{\theta\notin OL} L_\theta^{\mathrm{ED}}}{\frac{1}{N'}\sum_{\theta\notin OL} L_\theta^{\mathrm{ED}}} \times 100\%.
                  \]
                </li>
              </ul>
            </li>

            <li>
              <strong>(Global Circumferential Strain — GCS)</strong>:
              <ul>
                <li>
                  Extract \( N \) short-axis cross-sections within the mid-ventricular region, indexed by \( i \).  
                  <em>(In our study: \( N = 6 \))</em>
                </li>
                <li>Measure circumferences \( C_i^{\mathrm{ED}}, C_i^{\mathrm{ES}} \) using ellipse fitting.</li>
                <li>
                  Exclude the 1 largest and 1 smallest circumferences to retain \( N' \) representative cross-sections.  
                  <em>(In our study: \( N' = 4 \))</em>
                </li>
                <li>
                  Compute:
                  \[
                  GCS = \frac{\frac{1}{N'}\sum_{i\notin OL} C_i^{\mathrm{ES}} - \frac{1}{N'}\sum_{i\notin OL} C_i^{\mathrm{ED}}}{\frac{1}{N'}\sum_{i\notin OL} C_i^{\mathrm{ED}}} \times 100\%.
                  \]
                </li>
              </ul>
            </li>
          </ol>
          <p><em>Outlier removal (OL) ensures robust estimation by excluding extreme geometric deviations caused by noise or irregular contours.</em></p>
        </div>
      </details>
    </section>

    <!-- Dataset Access & Licensing -->
    <section id="data_acc" class="section">
      <h2>Dataset Access & Licensing</h2>
      <p>
        Data access is available upon request for non-commercial research use. Please contact the dataset team or fill in the 
        application form (coming soon).
      </p>
    </section>

    <!-- Code Repository & Publications -->
    <section id="code" class="section">
      <h2>Code Repository & Publications</h2>

      <h5 class="step-title">Code</h5>
      <p>
        Coming soon. Code and pre-trained models will be released on our 
        <a href="https://github.com/kamruleee51/FeEcho4D" target="_blank" rel="noopener noreferrer">GitHub</a>.
      </p>

      <h5 class="step-title">Paper</h5>
      <p>
        The FeEcho4D dataset and framework are described in our paper: <br>
        <em>"4D Reconstruction of Fetal Left Ventricle from Echocardiography via 2.5D Radial Segmentation and Graph-Fourier Reconstruction"</em><br>
        Preprint available soon.
      </p>
      <a href="Image/RadialSlicing.pdf" target="_blank" style="font-weight: 500; color: #0434e2;">
        [Download PDF]
      </a>
    </section>

  </div>

  <!-- Author section -->
  <div class="author-section text-center position-relative">
    <h2 style="font-weight: 600; font-size: 2rem; color: #ffffff; margin-bottom: 30px;">
      Team Members
    </h2>
    <div class="author-container d-flex justify-content-center flex-wrap mt-4">
      <!-- Author 1 -->
      <div class="author-card mx-3 my-2">
        <img src="Image/Author/MKH.jpg" alt="Author 1" class="author-photo">
        <h6>
          <a href="https://scholar.google.com/citations?user=36WXELIAAAAJ&hl=en" target="_blank" class="author-link">
            Md. Kamrul Hasan
          </a>
        </h6>
        <p>Ph.D.<br>Department of Bioengineering<br>Imperial College London</p>
      </div>
      <!-- Author 2 -->
      <div class="author-card mx-3 my-2">
        <img src="Image/Author/Qifeng.png" alt="Author 2" class="author-photo">
        <h6>
          <a href="https://github.com/QifengWang0702" target="_blank" class="author-link">
            Qifeng Wang
          </a>
        </h6>
        <p>Ph.D.<br>Department of Bioengineering<br>Imperial College London<br>DUT-RUISE<br>Dalian University of Technology</p>
      </div>
      <!-- Author 3 -->
      <div class="author-card mx-3 my-2">
        <img src="Image/Author/SH.jpeg" alt="Author 3" class="author-photo">
        <h6>
          <a href="https://github.com/haziqshahard" target="_blank" class="author-link">
            Shahard Haziq
          </a>
        </h6>
        <p>M.Eng.<br>Department of Bioengineering<br>Imperial College London</p>
      </div>
      <!-- Author 4 -->
      <div class="author-card mx-3 my-2">
        <img src="Image/Author/Yap.png" alt="Author 4" class="author-photo">
        <h6>
          <a href="https://profiles.imperial.ac.uk/c.yap" target="_blank" class="author-link">
            Choon Hwai Yap
          </a>
        </h6>
        <p>Assoc.Prof.<br>Department of Bioengineering<br>Imperial College London</p>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="text-center mt-5 mb-4">
    <p>&copy; 2025 FeEcho4D Project. Developed by Qifeng Wang.</p>
  </footer>

  <!-- JS libraries -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
